sap.ui.define(
	["sap/ui/core/mvc/Controller",
	"sap/m/MessageBox",
	"sap/ui/model/json/JSONModel"], function(Controller, MessageBox, JSONModel) {
	"use strict";
	return Controller.extend("ats.soapZSOAPCalls.controller.Main", {
		/**
		 *@memberOf ats.soapZSOAPCalls.controller.Main
		 */
		//Step 4: Define the Callbacks for response (success or Error)
		resSuccess: function(data, status, req) {
			var responseTotal = "";
			
			var dataXml = req.responseText;
			var parser = new DOMParser();
			var xmlDoc = parser.parseFromString(dataXml, "text/xml");
			responseTotal = xmlDoc.getElementsByTagName("AddIntegerResult")[0].childNodes[0].nodeValue;
			MessageBox.show(responseTotal);
		},
		resError: function(data, status, req){
			debugger;
		},
		onCallSOAP: function(oEvent) {
			//This code was generated by the layout editor.
			//1. Form Submit //2. HTTP Request Object in JS //3. jQuery AJAX 
			//Step 1: Read the values of Num1 and Num2
			var sNum1 = this.getView().byId("num1").getValue();
			var sNum2 = this.getView().byId("num2").getValue();
			//Step 2: Prepare the URL of SOAP service to call and add the Numbers to same
			var sUrl = "/csp/samples/SOAP.Demo.cls?soap_method=AddInteger&Arg1=" + sNum1 + "&Arg2=" + sNum2;			
			//Step 3: Make a call to the SOAP Service Using AJAX
			$.ajax({
				type: "GET",
				url: sUrl,
				content: "text/xml",
				dataType: "xml",
				success: this.resSuccess,
				error: this.resError
			});
			
			
		},
		successREST: function(data){
			var myData = data.value;
			//Step 1: Create a New JSON Model and set this data to model object
			var oModel = new JSONModel();
			oModel.setData({
				"newData": myData
			});
			var oList = this.getView().byId("restdata");
			//step 3: Set the model to the list level as default model
			oList.setModel(oModel);
			//Step 2: Bind our list control we entity set where array is present
			oList.bindItems({
				path: "/newData",
				template: new sap.m.DisplayListItem({
					label: "{CustomerID}",
					value: "{CompanyName}"
				})
			});
			
			
		},
		errorREST: function(error){
			debugger;
		},
		onRESTCall: function(){
			var sURL = "/V3/Northwind/Northwind.svc/Customers?$format=json";
			$.ajax({
				type: "GET",
				url: sURL,
				contentType: "application/json",
				dataType: "json",
				success: this.successREST.bind(this),
				error: [this.errorREST,this]
			});
		}
	});
});